@inject IGithubHttpClient GithubHttpClient

<div class="my-4">
  <h3 class="text-sm font-bold text-[#c9d1d9] mb-2">Languages Used</h3>
  <div class="flex flex-wrap gap-2">
    @if (_languages is not null)
    {
      @foreach (var language in _languages)
      {
        <div class="flex items-center space-x-1 text-[#c9d1d9]">
          <span class="w-2 h-2 rounded-full" style="background-color:@language.Key.GetLanguageBackgroundColor();"></span>
          <span class="text-sm">@language.Key</span>
        </div>
      }
    }
    else
    {
      <div class="bg-[#161b22] border border-[#30363d] shadow rounded-lg p-4 text-center">
        <p class="text-[#cf222e] font-semibold text-lg mb-2">No data available.</p>
        <p class="text-[#8b949e] text-sm">Please check back later or try refreshing the page.</p>
      </div>
    }
  </div>
</div>

@code {
  [Parameter]
  public string RepoName { get; set; } = string.Empty;

  private Dictionary<string, int> _languages = [];

  protected override async Task OnParametersSetAsync() => await FetchLanguages();

  private async Task FetchLanguages()
  {

    if (await GithubHttpClient.GetLanguagesUsedAsync(RepoName) is { } result
    && result.IsSuccess
    && result.Value is not null)
    {
      _languages = result.Value;
    }
  }
}